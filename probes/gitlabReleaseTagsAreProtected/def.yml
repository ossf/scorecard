# Copyright 2025 OpenSSF Scorecard Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

id: gitlabReleaseTagsAreProtected
lifecycle: stable
short: Check that GitLab release tags have appropriate creation restrictions
motivation: >
  On GitLab, restricting who can create release tags prevents unauthorized users from publishing malicious releases. This probe verifies that protected tag patterns exist for release tags with appropriate access restrictions.
implementation: >
  This probe checks if release tags are covered by protected tag patterns and ensures the CreateAccessLevels are restrictive (No one=0 or Maintainer+=40).
outcome:
  - The probe returns OutcomeTrue (8 points) if all release tags are covered by patterns that allow only "No one" (AccessLevel=0) to create tags.
  - The probe returns OutcomeTrue (4 points) if all release tags are covered by patterns that allow only Maintainer+ (AccessLevel>=40) to create tags.
  - The probe returns OutcomeFalse if release tags can be created by Developer (AccessLevel=30) or if some release tags are not covered by protective patterns.
  - The probe returns OutcomeNotApplicable for non-GitLab platforms or if there are no release tags.
remediation:
  onOutcome: False
  effort: Medium
  text:
    - Add protected tag patterns to restrict release tag creation to trusted users only.
  markdown:
    - For GitLab projects, configure protected tags with patterns matching your release tags (e.g., `v*`, `release-*`) with CreateAccessLevel set to "No one" or "Maintainer" minimum.
ecosystem:
  languages:
    - all
  clients:
    - gitlab
