# Copyright 2025 OpenSSF Scorecard Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

id: releasesHaveVerifiedSignatures
lifecycle: stable
short: Check that releases have cryptographically verified signatures
motivation: >
  Cryptographically verified signatures prove that artifacts have not been tampered with
  and were published by a trusted party. This check goes beyond detecting signature files
  to actually verifying them with public keys or transparency logs.
implementation: >
  The probe checks package registry artifacts (Maven Central, PyPI) and attempts to
  verify signatures using the appropriate method: GPG verification with keyservers for
  Maven artifacts, or Sigstore verification with Rekor transparency log for PyPI packages
  using PEP 740 attestations. For Maven, Sigstore signatures are preferred over GPG when
  both are available. PyPI packages are verified using the PEP 740 attestation format,
  which includes DSSE envelopes with in-toto statements and Sigstore bundle data.
outcome:
  - If a release/package has at least one successfully verified signature, the probe returns OutcomeTrue.
  - If a release/package has signatures but verification failed, the probe returns OutcomeFalse.
  - If there are no signatures to verify, the probe returns OutcomeNotApplicable.
remediation:
  onOutcome: False
  effort: Medium
  text:
    - Sign your releases with GPG or Sigstore signatures.
    - For Maven use the maven-gpg-plugin and upload to Maven Central.
    - For PyPI use sigstore-python to sign wheels and sdists with PEP 740 attestations.
  markdown:
    - Sign your releases with GPG or Sigstore signatures.
    - For Maven use the maven-gpg-plugin and upload to Maven Central.
    - For PyPI use [sigstore-python](https://github.com/sigstore/sigstore-python) to sign wheels and sdists with [PEP 740](https://peps.python.org/pep-0740/) attestations.
ecosystem:
  languages:
    - all
  clients:
    - github
    - gitlab
    - localdir
